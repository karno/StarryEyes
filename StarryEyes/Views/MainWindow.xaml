<controls:MetroWindow x:Class="StarryEyes.Views.MainWindow"
                      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                      xmlns:controls="clr-namespace:MahApps.Metro.Controls;assembly=MahApps.Metro"
                      xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
                      xmlns:ei="http://schemas.microsoft.com/expression/2010/interactions"
                      xmlns:flips="clr-namespace:StarryEyes.Views.WindowParts.Flips"
                      xmlns:i="http://schemas.microsoft.com/expression/2010/interactivity"
                      xmlns:l="http://schemas.livet-mvvm.net/2011/wpf"
                      xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
                      xmlns:sebehaviors="clr-namespace:StarryEyes.Views.Messaging.Behaviors"
                      xmlns:triggers="clr-namespace:StarryEyes.Views.Triggers"
                      xmlns:utils="clr-namespace:StarryEyes.Views.Utils"
                      xmlns:views="clr-namespace:StarryEyes.Views"
              xmlns:vc="clr-namespace:StarryEyes.Views.Controls"
                      xmlns:vm="clr-namespace:StarryEyes.ViewModels"
                      xmlns:windowParts="clr-namespace:StarryEyes.Views.WindowParts"
                      Title="{Binding WindowTitle}"
                      Width="1200"
                      Height="750"
                      Background="{DynamicResource BaseColorBackgroundBrush}"
                      Closing="OnClosing"
                      FontFamily="Meiryo"
                      GlowBrush="{DynamicResource AccentColorBrush}"
                      InputMethod.IsInputMethodEnabled="False"
                      ResizeMode="CanResizeWithGrip"
                      ShowIconOnTitleBar="True"
                      SnapsToDevicePixels="True"
                      TitleCaps="False"
                      TitleForeground="{DynamicResource TitleBarForegroundBrush}"
                      UseLayoutRounding="False"
                      mc:Ignorable="d">
    <controls:MetroWindow.Icon>
        <DrawingImage>
            <DrawingImage.Drawing>
                <DrawingGroup>
                    <DrawingGroup.Children>
                        <GeometryDrawing Brush="{DynamicResource TitleBarBackgroundBrush}" Geometry="F1 M 0,1.52588e-005L 192,1.52588e-005L 192,192L 0,192L 0,1.52588e-005 Z " />
                        <GeometryDrawing Brush="{DynamicResource TitleBarForegroundBrush}" Geometry="F1 M 152.165,61.5514C 151.278,67.244 148.668,73.1522 144.352,76.9687C 139.711,81.0733 133.242,83.0371 127.106,83.905L 127.962,90.5481C 134.466,89.5445 140.987,88.4454 147.309,86.617C 153.262,84.8951 158.954,82.3276 164.567,79.7011L 160.033,76.7274C 159.795,82.1485 158.831,87.7416 156.411,92.5982C 154.694,96.044 151.981,99.11 148.813,101.297C 145.101,103.859 140.622,105.374 136.177,106.13C 128.802,107.384 121.115,106.732 113.744,105.452L 112.759,110.943C 119.73,112.097 126.722,113.343 133.78,113.673C 141.15,114.018 148.581,113.513 155.879,112.432L 153.156,109.131C 151.613,113.214 149.047,117.099 145.691,119.891C 141.763,123.158 136.891,125.463 131.911,126.604C 124.807,128.231 117.213,127.597 110.049,126.259C 105.952,125.493 101.92,124.372 97.9475,123.11C 95.6219,122.37 93.3134,121.576 91.0205,120.741C 89.5815,120.216 88.143,119.69 86.6983,119.182C 85.947,118.917 85.1967,118.648 84.4366,118.41C 84.0727,118.296 83.7078,118.184 83.3391,118.087C 83.1944,118.049 83.049,118.013 82.9027,117.982C 82.7813,117.956 82.6592,117.933 82.5364,117.914C 82.2374,117.869 81.6458,117.781 81.6453,118.084C 81.6433,119.288 83.4763,119.686 84.5474,120.238C 86.124,121.049 87.7608,121.741 89.3936,122.432C 94.5879,124.633 99.6823,127.148 105.083,128.778C 116.805,132.316 130.782,133.347 141.808,128.023C 146.895,125.566 151.501,121.652 154.649,116.96C 156.705,113.895 157.965,110.348 159.241,106.885L 155.113,107.53C 148.162,108.464 141.093,108.902 134.094,108.453C 127.228,108.013 120.432,106.755 113.655,105.565L 112.714,110.806C 121.41,112.407 130.581,113.144 139.235,111.331C 144.445,110.24 149.641,108.119 153.812,104.811C 158.274,101.273 161.699,96.1742 163.587,90.8023C 165.655,84.9169 165.951,78.5039 166.198,72.2706L 161.978,74.2892C 156.649,76.7462 151.243,79.1273 145.609,80.7687C 139.575,82.5266 133.33,83.5072 127.116,84.4454L 127.834,90.023C 134.292,89.1338 140.949,87.2251 146.244,83.4231C 150.892,80.0866 154.599,75.0931 156.593,69.7307C 161.11,57.5814 158.902,42.4985 152.875,31.023C 151.358,28.1331 149.3,25.5525 147.306,22.9684L 145.175,26.588C 135.836,41.8766 123.893,56.6767 108.545,65.9175C 94.4434,74.408 77.7559,77.5769 62.2488,83.0967C 54.0399,86.2266 46.0749,90.7641 39.8116,96.9247C 35.024,101.634 31.0126,107.366 28.4925,113.59C 25.7202,120.438 24.6542,128.278 25.7552,135.583C 26.6056,141.226 28.8546,146.754 31.9736,151.533C 34.7274,155.356 38.1478,158.82 42.0785,161.418C 47.6532,165.104 54.5019,167.273 61.1808,167.506C 66.7113,167.698 72.4497,166.54 77.4387,164.145C 82.2358,161.843 86.4904,158.259 89.9117,154.183C 93.4173,149.662 95.9297,143.868 96.0297,138.148C 96.0995,134.16 95.1338,130.069 93.4072,126.474C 90.2897,119.983 84.2273,114.33 77.4405,111.924C 73.1159,110.39 68.0845,110.11 63.6849,111.412C 59.5818,112.627 55.8728,115.326 52.9479,118.449C 51.2037,120.503 49.7748,122.988 49.2266,125.626C 48.6445,128.427 49.0022,131.522 50.0982,134.166C 52.2626,139.385 58.6106,143.676 64.2579,143.485C 67.5516,143.374 71.1407,141.638 73.0406,138.945C 73.3451,138.514 73.8617,137.747 73.4512,137.415C 73.0444,137.086 72.3901,137.453 71.895,137.622C 70.9867,137.932 70.087,138.274 69.1609,138.526C 66.5816,139.228 63.5432,139.133 61.1649,137.913C 58.3256,136.456 55.9622,133.358 55.4901,130.202C 55.1108,127.667 56.1569,124.815 57.8358,122.877C 59.9548,120.659 62.5877,118.666 65.5452,117.853C 68.3739,117.076 71.5415,117.177 74.3438,118.045C 81.5633,120.28 88.0632,127.861 88.9765,135.363C 89.585,140.362 87.63,145.826 84.5439,149.804C 81.7678,153.107 78.3156,155.997 74.441,157.895C 70.4609,159.844 65.8483,160.769 61.4203,160.584C 55.9777,160.358 50.433,158.573 45.8461,155.634C 42.6417,153.582 39.8968,150.753 37.6665,147.67C 35.0907,143.741 33.2323,139.192 32.5215,134.548C 31.5852,128.431 32.4863,121.865 34.7941,116.123C 36.9552,110.747 40.4067,105.79 44.5373,101.727C 50.1338,96.2208 57.2419,92.1581 64.5693,89.3395C 80.4348,83.6387 97.3928,80.0966 111.894,71.4978C 128.215,61.8195 140.803,46.0305 150.669,29.8222L 144.849,30.197C 147.662,33.9557 149.488,38.465 150.742,42.9893C 152.4,48.9694 153.155,55.4254 152.165,61.5514 Z " />
                    </DrawingGroup.Children>
                </DrawingGroup>
            </DrawingImage.Drawing>
        </DrawingImage>
    </controls:MetroWindow.Icon>
    <controls:MetroWindow.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="pack://application:,,,/MahApps.Metro;component/Styles/Colors.xaml" />
                <ResourceDictionary Source="pack://application:,,,/MahApps.Metro;component/Styles/Fonts.xaml" />
                <ResourceDictionary Source="pack://application:,,,/MahApps.Metro;component/Styles/Controls.xaml" />
                <!--  <ResourceDictionary Source="pack://application:,,,/MahApps.Metro;component/Styles/Accents/BaseLight.xaml" />  -->
                <ResourceDictionary Source="../Themes/WindowBase.xaml" />
            </ResourceDictionary.MergedDictionaries>
            <utils:BooleanToInvisibleConverter x:Key="BooleanToInvisibleConverter" />
            <utils:BooleanToVisibleConverter x:Key="BooleanToVisibleConverter" />
            <utils:WindowMaximizeToInvisibleConverter x:Key="MaximizeToInvisibleConverter" />
            <utils:BottomInvertedThicknessConverter x:Key="BottomThicknessConverter" />
        </ResourceDictionary>
    </controls:MetroWindow.Resources>
    <controls:MetroWindow.DataContext>
        <vm:MainWindowViewModel />
    </controls:MetroWindow.DataContext>
    <i:Interaction.Triggers>
        <ei:DataTrigger Binding="{Binding RotateWindowContent}" Value="True">
            <ei:ChangePropertyAction PropertyName="Angle"
                                     TargetObject="{Binding ElementName=Rotation}"
                                     Value="180" />
        </ei:DataTrigger>
        <ei:DataTrigger Binding="{Binding RotateWindowContent}" Value="False">
            <ei:ChangePropertyAction PropertyName="Angle"
                                     TargetObject="{Binding ElementName=Rotation}"
                                     Value="0" />
        </ei:DataTrigger>
        <!--  WindowのContentRenderedイベントのタイミングでViewModelのInitializeメソッドが呼ばれます  -->
        <i:EventTrigger EventName="ContentRendered">
            <l:LivetCallMethodAction MethodName="Initialize" MethodTarget="{Binding}" />
        </i:EventTrigger>
        <!--  Windowが閉じたタイミングでViewModelのDisposeメソッドが呼ばれます  -->
        <i:EventTrigger EventName="Closed">
            <l:DataContextDisposeAction />
        </i:EventTrigger>
        <l:InteractionMessageTrigger Messenger="{Binding Messenger}">
            <l:TransitionInteractionMessageAction />
        </l:InteractionMessageTrigger>
        <l:InteractionMessageTrigger Messenger="{Binding Messenger}">
            <sebehaviors:TaskDialogInteractionMessageAction />
        </l:InteractionMessageTrigger>
        <!--  WindowのCloseキャンセル処理に対応する場合は、WindowCloseCancelBehaviorの使用を検討してください  -->
        <triggers:KeyAssignTrigger />
    </i:Interaction.Triggers>
    <controls:MetroWindow.WindowCommands>
        <controls:WindowCommands>
            <StackPanel VerticalAlignment="Center" Visibility="{Binding SearchFlipViewModel.IsVisible, Converter={StaticResource BooleanToInvisibleConverter}}">
                <Button Command="{Binding ShowSettingCommand}"
                        Content="settings"
                        Visibility="{Binding ShowWindowCommands,
                                             Converter={StaticResource BooleanToVisibleConverter}}" />
            </StackPanel>
            <TextBox Width="180"
                     Height="20"
                     Margin="-1,0,2,0"
                     VerticalContentAlignment="Center"
                     BorderThickness="0"
                     Opacity="0.8"
                     Text="{Binding SearchFlipViewModel.Text,
                                    UpdateSourceTrigger=PropertyChanged}"
                     Visibility="{Binding ShowWindowCommands,
                                          Converter={StaticResource BooleanToVisibleConverter}}"
                     controls:TextboxHelper.ClearTextButton="True"
                     controls:TextboxHelper.Watermark="{Binding SearchFlipViewModel.SearchHintLabel,
                                                                FallbackValue=search}">
                <i:Interaction.Triggers>
                    <l:InteractionMessageTrigger MessageKey="FocusToTextBox" Messenger="{Binding SearchFlipViewModel.Messenger}">
                        <l:SetFocusAction />
                    </l:InteractionMessageTrigger>
                    <i:EventTrigger EventName="GotFocus">
                        <ei:CallMethodAction MethodName="GotFocusToSearchBox" TargetObject="{Binding SearchFlipViewModel}" />
                    </i:EventTrigger>
                    <triggers:EnterKeyTrigger>
                        <ei:CallMethodAction MethodName="OnEnterKeyDown" TargetObject="{Binding SearchFlipViewModel}" />
                    </triggers:EnterKeyTrigger>
                    <triggers:KeyAssignTrigger Group="Search" />
                </i:Interaction.Triggers>
            </TextBox>
        </controls:WindowCommands>
    </controls:MetroWindow.WindowCommands>
    <Grid>
        <i:Interaction.Triggers>
            <ei:DataTrigger Binding="{Binding BackstageViewModel.ShowCurrentEvent,
                                              Mode=OneWay}"
                            Comparison="Equal"
                            Value="True">
                <ei:GoToStateAction StateName="ShowCurrentEvent" />
            </ei:DataTrigger>
            <ei:DataTrigger Binding="{Binding BackstageViewModel.ShowCurrentEvent,
                                              Mode=OneWay}"
                            Comparison="Equal"
                            Value="False">
                <ei:GoToStateAction StateName="HideCurrentEvent" />
            </ei:DataTrigger>
        </i:Interaction.Triggers>
        <VisualStateManager.VisualStateGroups>
            <VisualStateGroup x:Name="CurrentEventStates">
                <VisualState x:Name="ShowCurrentEvent">
                    <Storyboard>
                        <DoubleAnimationUsingKeyFrames Storyboard.TargetName="CurrentEventBorder" Storyboard.TargetProperty="(UIElement.RenderTransform).(TransformGroup.Children)[3].(TranslateTransform.Y)">
                            <EasingDoubleKeyFrame KeyTime="0" Value="30">
                                <EasingDoubleKeyFrame.EasingFunction>
                                    <ExponentialEase EasingMode="EaseOut" Exponent="10" />
                                </EasingDoubleKeyFrame.EasingFunction>
                            </EasingDoubleKeyFrame>
                            <EasingDoubleKeyFrame KeyTime="0:0:0.1" Value="0">
                                <EasingDoubleKeyFrame.EasingFunction>
                                    <ExponentialEase EasingMode="EaseOut" Exponent="10" />
                                </EasingDoubleKeyFrame.EasingFunction>
                            </EasingDoubleKeyFrame>
                            <!--  remove calculation error  -->
                            <EasingDoubleKeyFrame KeyTime="0:0:0.1" Value="0" />
                        </DoubleAnimationUsingKeyFrames>
                        <DoubleAnimationUsingKeyFrames Storyboard.TargetName="CurrentEventBorder" Storyboard.TargetProperty="(UIElement.Opacity)">
                            <EasingDoubleKeyFrame KeyTime="0" Value="0">
                                <EasingDoubleKeyFrame.EasingFunction>
                                    <ExponentialEase EasingMode="EaseOut" Exponent="10" />
                                </EasingDoubleKeyFrame.EasingFunction>
                            </EasingDoubleKeyFrame>
                            <EasingDoubleKeyFrame KeyTime="0:0:0.1" Value="1">
                                <EasingDoubleKeyFrame.EasingFunction>
                                    <ExponentialEase EasingMode="EaseOut" Exponent="10" />
                                </EasingDoubleKeyFrame.EasingFunction>
                            </EasingDoubleKeyFrame>
                        </DoubleAnimationUsingKeyFrames>
                    </Storyboard>
                </VisualState>
                <VisualState x:Name="HideCurrentEvent">
                    <Storyboard>
                        <DoubleAnimationUsingKeyFrames Storyboard.TargetName="CurrentEventBorder" Storyboard.TargetProperty="(UIElement.Opacity)">
                            <EasingDoubleKeyFrame KeyTime="0" Value="1">
                                <EasingDoubleKeyFrame.EasingFunction>
                                    <ExponentialEase EasingMode="EaseOut" Exponent="10" />
                                </EasingDoubleKeyFrame.EasingFunction>
                            </EasingDoubleKeyFrame>
                            <EasingDoubleKeyFrame KeyTime="0:0:0.1" Value="0">
                                <EasingDoubleKeyFrame.EasingFunction>
                                    <ExponentialEase EasingMode="EaseOut" Exponent="10" />
                                </EasingDoubleKeyFrame.EasingFunction>
                            </EasingDoubleKeyFrame>
                        </DoubleAnimationUsingKeyFrames>
                        <DoubleAnimationUsingKeyFrames Storyboard.TargetName="CurrentEventBorder" Storyboard.TargetProperty="(UIElement.RenderTransform).(TransformGroup.Children)[3].(TranslateTransform.Y)">
                            <EasingDoubleKeyFrame KeyTime="0" Value="0">
                                <EasingDoubleKeyFrame.EasingFunction>
                                    <ExponentialEase EasingMode="EaseIn" Exponent="10" />
                                </EasingDoubleKeyFrame.EasingFunction>
                            </EasingDoubleKeyFrame>
                            <EasingDoubleKeyFrame KeyTime="0:0:0.1" Value="30">
                                <EasingDoubleKeyFrame.EasingFunction>
                                    <ExponentialEase EasingMode="EaseIn" Exponent="10" />
                                </EasingDoubleKeyFrame.EasingFunction>
                            </EasingDoubleKeyFrame>
                        </DoubleAnimationUsingKeyFrames>
                    </Storyboard>
                </VisualState>
            </VisualStateGroup>
            <VisualStateGroup x:Name="ForePanelStates">
                <VisualState x:Name="HideForePanel">
                    <Storyboard>
                        <DoubleAnimationUsingKeyFrames Storyboard.TargetName="MainAreaGrid" Storyboard.TargetProperty="(UIElement.Opacity)">
                            <EasingDoubleKeyFrame KeyTime="0:0:0.2" Value="0">
                                <EasingDoubleKeyFrame.EasingFunction>
                                    <ExponentialEase EasingMode="EaseIn" Exponent="10" />
                                </EasingDoubleKeyFrame.EasingFunction>
                            </EasingDoubleKeyFrame>
                        </DoubleAnimationUsingKeyFrames>
                        <DoubleAnimationUsingKeyFrames Storyboard.TargetName="MainAreaGrid" Storyboard.TargetProperty="(UIElement.RenderTransform).(TransformGroup.Children)[3].(TranslateTransform.Y)">
                            <EasingDoubleKeyFrame KeyTime="0:0:0.2" Value="800">
                                <EasingDoubleKeyFrame.EasingFunction>
                                    <CubicEase EasingMode="EaseIn" />
                                </EasingDoubleKeyFrame.EasingFunction>
                            </EasingDoubleKeyFrame>
                        </DoubleAnimationUsingKeyFrames>
                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="MainAreaGrid" Storyboard.TargetProperty="(UIElement.Visibility)">
                            <DiscreteObjectKeyFrame KeyTime="0:0:0.2" Value="{x:Static Visibility.Collapsed}" />
                        </ObjectAnimationUsingKeyFrames>
                    </Storyboard>
                </VisualState>
                <VisualState x:Name="ShowForePanel">
                    <Storyboard>
                        <DoubleAnimationUsingKeyFrames Storyboard.TargetName="MainAreaGrid" Storyboard.TargetProperty="(UIElement.RenderTransform).(TransformGroup.Children)[3].(TranslateTransform.Y)">
                            <EasingDoubleKeyFrame KeyTime="0" Value="800">
                                <EasingDoubleKeyFrame.EasingFunction>
                                    <ExponentialEase EasingMode="EaseOut" Exponent="10" />
                                </EasingDoubleKeyFrame.EasingFunction>
                            </EasingDoubleKeyFrame>
                            <EasingDoubleKeyFrame KeyTime="0:0:0.2" Value="0">
                                <EasingDoubleKeyFrame.EasingFunction>
                                    <ExponentialEase EasingMode="EaseOut" Exponent="10" />
                                </EasingDoubleKeyFrame.EasingFunction>
                            </EasingDoubleKeyFrame>
                        </DoubleAnimationUsingKeyFrames>
                        <DoubleAnimationUsingKeyFrames Storyboard.TargetName="MainAreaGrid" Storyboard.TargetProperty="(UIElement.Opacity)">
                            <EasingDoubleKeyFrame KeyTime="0" Value="0">
                                <EasingDoubleKeyFrame.EasingFunction>
                                    <ExponentialEase EasingMode="EaseOut" Exponent="10" />
                                </EasingDoubleKeyFrame.EasingFunction>
                            </EasingDoubleKeyFrame>
                            <EasingDoubleKeyFrame KeyTime="0:0:0.2" Value="1">
                                <EasingDoubleKeyFrame.EasingFunction>
                                    <ExponentialEase EasingMode="EaseOut" Exponent="10" />
                                </EasingDoubleKeyFrame.EasingFunction>
                            </EasingDoubleKeyFrame>
                        </DoubleAnimationUsingKeyFrames>
                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="MainAreaGrid" Storyboard.TargetProperty="(UIElement.Visibility)">
                            <DiscreteObjectKeyFrame KeyTime="0" Value="{x:Static Visibility.Visible}" />
                            <DiscreteObjectKeyFrame KeyTime="0:0:0.2" Value="{x:Static Visibility.Visible}" />
                        </ObjectAnimationUsingKeyFrames>
                    </Storyboard>
                </VisualState>
            </VisualStateGroup>
        </VisualStateManager.VisualStateGroups>
        <Grid.RowDefinitions>
            <RowDefinition />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>

        <Grid Grid.Row="0">
            <i:Interaction.Triggers>
                <ei:DataTrigger Binding="{Binding IsBackstageVisible, Mode=OneWay}" Value="True">
                    <ei:GoToStateAction StateName="HideForePanel" />
                </ei:DataTrigger>
                <ei:DataTrigger Binding="{Binding IsBackstageVisible, Mode=OneWay}" Value="False">
                    <ei:GoToStateAction StateName="ShowForePanel" />
                </ei:DataTrigger>
            </i:Interaction.Triggers>
            <windowParts:Backstage DataContext="{Binding BackstageViewModel}" />
            <Grid x:Name="MainAreaGrid"
                  Background="{DynamicResource BaseColorBackgroundBrush}"
                  RenderTransformOrigin="0.5,0.5">
                <Grid.LayoutTransform>
                    <RotateTransform x:Name="Rotation" Angle="0" CenterX="0.5" CenterY="0.5" />
                </Grid.LayoutTransform>
                <Grid.RenderTransform>
                    <TransformGroup>
                        <ScaleTransform />
                        <SkewTransform />
                        <RotateTransform />
                        <TranslateTransform />
                    </TransformGroup>
                </Grid.RenderTransform>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="13*" />
                </Grid.RowDefinitions>
        <vc:LazyImage
                    Grid.RowSpan="2"
                       Margin="{Binding ElementName=StatusGrid,
                                        Path=ActualHeight,
                                        Converter={StaticResource BottomThicknessConverter}}"
                       Opacity="{Binding BackgroundImageOpacity}"
               UriSource="{Binding BackgroundImageUri}"
                       Stretch="UniformToFill">
            </vc:LazyImage>
                <windowParts:InputArea Grid.Row="0"
                                       Margin="3,4,3,0"
                                       DataContext="{Binding InputAreaViewModel}" />
                <windowParts:MainArea Grid.Row="1"
                                      Margin="-8,0,0,0"
                                      DataContext="{Binding MainAreaViewModel}" />
            </Grid>
        </Grid>
        <Grid Name="StatusGrid"
              Grid.Row="1"
              Background="#00FFFFFF">
            <i:Interaction.Triggers>
                <i:EventTrigger EventName="MouseLeftButtonDown">
                    <ei:CallMethodAction MethodName="ToggleShowBackstage" TargetObject="{Binding}" />
                </i:EventTrigger>
            </i:Interaction.Triggers>
            <Grid Margin="0">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition />
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="Auto" />
                </Grid.ColumnDefinitions>
                <TextBlock Margin="8"
                           Text="{Binding StateString}"
                           ToolTip="ここをクリックすると、バックステージを開くことができます。" />
                <StackPanel Grid.Column="1"
                            Margin="8"
                            Orientation="Horizontal"
                            ToolTip="現在保持している総ツイート数です。">
                    <Path Width="9"
                          Height="11"
                          Margin="0,2,4,0"
                          VerticalAlignment="Center"
                          Data="F1 M 24,18C 27.0376,18 29.5,18.6716 29.5,19.5C 29.5,19.8842 28.9704,20.2346 28.0995,20.5C 27.0924,20.8069 25.6289,21 24,21C 22.3711,21 20.9076,20.8069 19.9005,20.5C 19.0296,20.2346 18.5,19.8842 18.5,19.5C 18.5,18.6716 20.9624,18 24,18 Z M 29.5,28.5C 29.5,29.3284 27.0376,30 24,30C 20.9624,30 18.5,29.3284 18.5,28.5L 18.5,26.5C 18.5,27.3284 20.9624,28 24,28C 27.0376,28 29.5,27.3284 29.5,26.5L 29.5,28.5 Z M 29.5,25.5C 29.5,26.3284 27.0376,27 24,27C 20.9624,27 18.5,26.3284 18.5,25.5L 18.5,23.5C 18.5,24.3284 20.9624,25 24,25C 27.0376,25 29.5,24.3284 29.5,23.5L 29.5,25.5 Z M 29.5,22.5C 29.5,23.3284 27.0376,24 24,24C 20.9624,24 18.5,23.3284 18.5,22.5L 18.5,20.5C 18.5,21.3284 20.9624,22 24,22C 27.0376,22 29.5,21.3284 29.5,20.5L 29.5,22.5 Z "
                          Fill="{DynamicResource BaseColorForegroundBrush}"
                          Stretch="Fill" />
                    <TextBlock Height="15.24"
                               Margin="0,0,16,0"
                               FontFamily="Segoe UI"
                               Text="{Binding GrossTweetCount}" />
                </StackPanel>
                <StackPanel Grid.Column="2"
                            Margin="8"
                            Orientation="Horizontal"
                            ToolTip="一分間あたりのツイート受信数の目安です。">
                    <Path Width="12"
                          Height="7.5"
                          Margin="0,2,4,0"
                          Data="F1 M 20.4704,34.6073L 17.9998,34.6073C 17.9998,31.2936 20.6861,28.6073 23.9998,28.6073C 27.3135,28.6073 29.9998,31.2936 29.9998,34.6073L 27.5292,34.6073L 27.1763,34.4309C 27.1763,32.6766 25.7541,31.2544 23.9998,31.2544C 22.2455,31.2544 20.8233,32.6766 20.8233,34.4309L 20.4704,34.6073 Z M 23.6166,29.3269C 22.4318,29.4116 21.355,29.8862 20.5136,30.6231L 21.2108,31.4199C 21.8839,30.8305 22.7454,30.4508 23.6932,30.383L 23.6166,29.3269 Z M 27.486,30.6231C 26.6446,29.8862 25.5678,29.4116 24.383,29.3269L 24.3064,30.383C 25.2542,30.4508 26.1157,30.8305 26.7888,31.4199L 27.486,30.6231 Z M 27.9841,31.1211L 27.1872,31.8184C 27.7497,32.4607 28.1212,33.2745 28.2129,34.1712L 29.2662,34.0621C 29.1515,32.9413 28.6872,31.924 27.9841,31.1211 Z M 20.0155,31.1211C 19.3124,31.924 18.8481,32.9413 18.7334,34.0621L 19.7867,34.1712C 19.8784,33.2745 20.2499,32.4607 20.8124,31.8184L 20.0155,31.1211 Z M 24.7924,34.5846C 25.1171,34.958 25.0775,35.5239 24.7041,35.8486C 24.3306,36.1732 23.7647,36.1336 23.4401,35.7602L 22.2697,32.8205L 24.7924,34.5846 Z "
                          Fill="{DynamicResource BaseColorForegroundBrush}"
                          Stretch="Fill" />
                    <TextBlock Height="15.24"
                               Margin="0,0,16,0"
                               FontFamily="Segoe UI"
                               Text="{Binding TweetsPerMinutes,
                                              Mode=OneWay}" />
                </StackPanel>
                <StackPanel Grid.Column="3"
                            Margin="8"
                            Orientation="Horizontal"
                            ToolTip="Krileの起動時間です。">
                    <Path Width="11"
                          Height="11"
                          Margin="0,2,4,0"
                          VerticalAlignment="Center"
                          Data="F1 M 24,19.9091C 26.5104,19.9091 28.5455,21.9442 28.5455,24.4545C 28.5455,26.9649 26.5104,29 24,29C 21.4896,29 19.4545,26.9649 19.4545,24.4545C 19.4545,21.9442 21.4896,19.9091 24,19.9091 Z M 24,21.0455C 22.1172,21.0455 20.5909,22.5718 20.5909,24.4545C 20.5909,26.3373 22.1172,27.8636 24,27.8636C 25.8828,27.8636 27.4091,26.3373 27.4091,24.4545C 27.4091,22.5718 25.8828,21.0455 24,21.0455 Z M 23.8864,21.9545C 24.1374,21.9545 24.3409,22.1581 24.3409,22.4091L 24.3409,24.1136L 26.0454,24.1136C 26.2965,24.1136 26.5,24.3171 26.5,24.5682L 26.5,24.7955C 26.5,25.0465 26.2965,25.25 26.0455,25.25L 24,25.25C 23.7727,25.2121 23.5454,25.1742 23.4129,25.0417C 23.2803,24.9091 23.2424,24.6818 23.2045,24.4546L 23.2045,22.4091C 23.2045,22.1581 23.408,21.9545 23.6591,21.9545L 23.8864,21.9545 Z M 27.1818,19C 28.186,19 29,19.814 29,20.8182C 29,21.2514 28.8485,21.6492 28.5956,21.9615C 28.0028,20.871 27.033,20.015 25.8613,19.5684C 26.1927,19.2183 26.6618,19 27.1818,19 Z M 20.8182,19C 21.3382,19 21.8073,19.2184 22.1387,19.5684C 20.9669,20.015 19.9972,20.871 19.4044,21.9615C 19.1515,21.6492 19,21.2514 19,20.8182C 19,19.814 19.814,19 20.8182,19 Z "
                          Fill="{DynamicResource BaseColorForegroundBrush}"
                          Stretch="Fill" />
                    <TextBlock Height="15.24"
                               Margin="0"
                               FontFamily="Segoe UI"
                               Text="{Binding StartupTime}" />
                </StackPanel>
                <Canvas Grid.Column="4"
                        Width="12"
                        Visibility="{Binding RelativeSource={RelativeSource Mode=FindAncestor,
                                                                            AncestorType={x:Type Window}},
                                             Path=WindowState,
                                             Converter={StaticResource MaximizeToInvisibleConverter}}" />
            </Grid>
            <Border x:Name="CurrentEventBorder"
                    Opacity="0"
                    RenderTransformOrigin="0.5,0.5"
                    SnapsToDevicePixels="True">
                <Border.RenderTransform>
                    <TransformGroup>
                        <ScaleTransform />
                        <SkewTransform />
                        <RotateTransform />
                        <TranslateTransform Y="100" />
                    </TransformGroup>
                </Border.RenderTransform>
                <Border.Background>
                    <SolidColorBrush Color="{Binding BackstageViewModel.CurrentEvent.Background, Mode=OneWay}" />
                </Border.Background>
                <StackPanel Orientation="Horizontal">
                    <Image Width="16"
                           Height="16"
                           Margin="8,8,4,8"
                           VerticalAlignment="Center"
                           Source="{Binding BackstageViewModel.CurrentEvent.TitleImage,
                                            Mode=OneWay}"
                           Visibility="{Binding BackstageViewModel.CurrentEvent.IsImageAvailable,
                                                Converter={StaticResource BooleanToVisibleConverter},
                                                Mode=OneWay}" />
                    <TextBlock Margin="8,8,4,8"
                               VerticalAlignment="Center"
                               FontWeight="Bold"
                               Text="{Binding BackstageViewModel.CurrentEvent.Title,
                                              Mode=OneWay}"
                               Visibility="{Binding BackstageViewModel.CurrentEvent.IsImageAvailable,
                                                    Converter={StaticResource BooleanToInvisibleConverter},
                                                    Mode=OneWay}">
                        <TextBlock.Foreground>
                            <SolidColorBrush Color="{Binding BackstageViewModel.CurrentEvent.Foreground, Mode=OneWay}" />
                        </TextBlock.Foreground>
                    </TextBlock>
                    <TextBlock Margin="4,8,8,8"
                               VerticalAlignment="Center"
                               Text="{Binding BackstageViewModel.CurrentEvent.Detail,
                                              Mode=OneWay}">
                        <TextBlock.Foreground>
                            <SolidColorBrush Color="{Binding BackstageViewModel.CurrentEvent.Foreground, Mode=OneWay}" />
                        </TextBlock.Foreground>
                    </TextBlock>
                </StackPanel>
            </Border>
        </Grid>
        <flips:AccountSelectionFlip Grid.RowSpan="2"
                                    Margin="0,-30,0,0"
                                    DataContext="{Binding InputAreaAccountSelectionFlipViewModel}" />
        <flips:SearchFlip Grid.RowSpan="2"
                          Margin="0,-30,0,0"
                          DataContext="{Binding SearchFlipViewModel}" />
        <flips:AccountSelectionFlip Grid.RowSpan="2"
                                    Margin="0,-30,0,0"
                                    DataContext="{Binding GlobalAccountSelectionFlipViewModel}" />
        <flips:TabConfigurationFlip Grid.RowSpan="2"
                                    Margin="0,-30,0,0"
                                    DataContext="{Binding TabConfigurationFlipViewModel}" />
        <flips:SettingFlip Grid.RowSpan="2"
                           Margin="0,-30,0,0"
                           DataContext="{Binding SettingFlipViewModel}" />
    </Grid>
</controls:MetroWindow>